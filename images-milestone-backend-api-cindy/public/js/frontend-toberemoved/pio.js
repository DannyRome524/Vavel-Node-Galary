/* printio_widget@v2.9.6m,  licensed. http://print.io */!function(a){var b=function(){var b={v:"1",hasOpenChannel:!1,opts:{},lastOpts:{},fallbackCountry:"",hadConfig:!1,fns:{},hasLocalStorage:!1,hadHistWire:!1,pHist:[],pHistPointer:0},c=this,d=-1!==a.navigator.userAgent.toUpperCase().indexOf("MSIE 9"),e=function(a){return"pio."+b.v+"."+a},f={debug:!1,embedInElement:!1,images:[],items:[],canUseUpload:!0,skipProductDetails:!1,canBuyOtherProducts:!0,canUseMap:!0,alwaysUseSingleTemplate:!1,hideComingSoonProducts:!1,goTo:"",goToCustomize:!1,orderId:null,usePushState:!0,fadeBackground:!0,countryCode:"",currencyCode:"",languageCode:"",preLoad:{on:!1},fns:{onCartChange:function(){},onClose:function(){},onOpen:function(){},onEvent:function(){}},style:{showHeader:!0,cssUrl:""},iframeStyles:{},vars:{},recipeId:"",url:"http://staging.widget.print.io/widget/",helpUrl:"",productsUrl:"",confirmationUrl:"",supportEmail:"",coupon:null,disableEditInCart:null,preserveCollection:null},g=function(a){return void 0===a},h=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},i=function(a,c){var d=b;return d.fns.hasOwnProperty(a)?d.fns[a].apply(d.fns[a],c):void 0},j=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))},k=function(){return a&&a.console?function(){console.log.apply(console,arguments)}:function(){}},l=function(a,b){var c={};if(!b)return a;for(var d in a)c[d]=b.hasOwnProperty(d)?h(a[d])?b[d].slice(0):b[d]:h(a[d])?a[d].slice(0):a[d];return c},m=function(b){var c=a.location,d=c.protocol+"//"+c.hostname,e=c.pathname,f=c.port;return f&&80!=f&&(d+=":"+f),d+="/",b?e.lastIndexOf("/")<1?d:d+e.substr(1,e.lastIndexOf("/")+1):d},n=function(){var c=b.lastOpts,d=document.createElement("iframe"),e=d.style,f=c.style,h=c.url,i=c.languageCode,j=c.recipeId,k=c.countryCode,l=b.fallbackCountry,m=c.preLoad.on;if(i=i||"en","/"!=h[h.length-1]&&(h+="/"),"https://api.print.io/widget/"===h&&(h="https://widget.print.io/widget/"),(k||l)&&i?(d.src+=h+(k||l).toLowerCase()+"/"+i.toLowerCase()+"/"+j,c.debug&&(d.src+="?debug=true")):(d.src=h+j,(k||i||c.debug||l)&&(d.src+="?",i&&(d.src+="language="+i+"&"),k?d.src+="country="+k+"&":l&&(d.src+="country="+l+"&"),c.debug&&(d.src+="debug=true&"),d.src=d.src.substr(0,d.src.length-1))),d.id="__pio",e.width="98%",e.maxWidth="960px",e.height="700px",!f||g(f.showHeader)||f.showHeader||(e.height="650px"),d.frameBorder=0,d.setAttribute("seamless","seamless"),d.marginHeight=0,d.marginWidth=0,d.hspace=0,d.vspace=0,e.margin="auto",e.boxSizing="border-box",e.borderRadius="5px",e.overflow="none",e.zIndex=999999,c.embedInElement||(e.position="absolute",e.left=0,e.right=0,e.top=f&&f.top?f.top:(void 0!==a.pageYOffset?a.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop)+20+"px"),c.iframeStyles)for(var n in c.iframeStyles)e[n]=c.iframeStyles[n];return m&&(d.id="__piop",e.width="0px",e.height="0px"),d},o=function(){return document.getElementById("__pio")},p=function(a){var b=o(),c=document.getElementById("__pio_f"),d=a||i("onClose");a&&(d=!0),(void 0===d||d===!0)&&(b&&b.parentNode.removeChild(b),c&&c.parentNode.removeChild(c));var e=document.getElementById("__piop");e&&e.parentNode.removeChild(e)},q=function(){return!!b.lastOpts.embedInElement&&!b.lastOpts.preLoad.on},r=function(a){q()?b.lastOpts.embedInElement.appendChild(a):document.getElementsByTagName("body")[0].appendChild(a)},s=function(){var a=b.lastOpts,c=document.createElement("div"),d=c.style;!a.fadeBackground||q()||a.preLoad.on||document.getElementById("__pio_f")||(d.position="absolute",d.top="0px",d.left="0px",d.width="100%",d.height=Math.max(document.documentElement.scrollHeight,document.height||document.documentElement.clientWidth)+"px",d.background="rgba(0,0,0,.7)",d.zIndex=999998,c.id="__pio_f",document.getElementsByTagName("body")[0].appendChild(c),c.addEventListener("click",function(){p()}))},t=function(d){if("close"===d.cmd)p();else if("hi"===d.cmd)x("set-options",b.lastOpts);else if("onCartChange"===d.cmd)C(d.data);else if("onChangeCountry"===d.cmd)null!=d.data&&c.setFallbackCountry(d.data);else if("paypal"===d.cmd){var e=document.createElement("div"),f=a.location.toString();b.lastOpts.confirmationUrl&&(f=b.lastOpts.confirmationUrl),e.innerHTML=d.data.replace("!RRR!",f),document.body.appendChild(e);var g=document.getElementsByClassName("js-paypal-form")[0];g.submit()}else if("analytics-addTransaction"===d.cmd)a.ga&&ga("ecommerce:addTransaction",d.data);else if("analytics-addItem"===d.cmd)a.ga&&ga("ecommerce:addItem",d.data);else if("analytics-send"===d.cmd)a.ga&&ga("ecommerce:send");else if("analytics-event"===d.cmd)a.ga&&ga("send",d.data);else if("analytics-pageview"===d.cmd)a.ga&&ga("send","pageview",d.data);else if("open-page"===d.cmd)d.data&&a.open(d.data,"_blank");else if("redirect-to-page"===d.cmd)d.data&&a.location.replace(d.data);else if("help-page"===d.cmd)b.lastOpts.helpUrl&&a.open(b.lastOpts.helpUrl,"_blank");else if("section-init"===d.cmd){if(b.hadHistWire&&d.data.tplName){if(!b.justPopped){var h=d.data.tplName;a.history.pushState({n:h},"","")}b.justPopped=!1}}else if("order-confirmation"===d.cmd){var j=b.lastOpts.confirmationUrl;j&&(j+=j.indexOf("?")>0?"&orderid="+d.data:"?orderid="+d.data,a.location.replace(j))}else"should-preload"===d.cmd?document.getElementById("__piop")&&x("do-preload",{}):"onGalleryChange"===d.cmd&&B("images",d.data);i("onEvent",[d.cmd,d.data])},u=function(a){var b=a.data||a.originalEvent.data;if(d)try{b=JSON.parse(b)}catch(c){}if(b&&b.data&&b.data.cmd&&(b.hasOwnProperty("PIOF")||b.hasOwnProperty("PIOP"))){var e=b.data;t(e)}};this._m=function(a){t(a)};var v=!1,w=function(){b.hasLocalStorage=z();var d=A("countryCode");if(d?b.fallbackCountry=d:G(),!v){var e=a.location.toString(),f=(-1!==e.indexOf("paypalreturn")&&-1!==e.indexOf("orderid"),j("orderid"));f&&c.clearCart(),v=!0}},x=function(a,b){var c=document.getElementById("__pio")||document.getElementById("__piop"),e={PIOP:!0,cmd:a,data:b};d&&(e=JSON.stringify(e)),c.contentWindow.postMessage(e,"*")},y=function(){b.hasOpenChannel||(a.addEventListener("message",u,!1),b.hasOpenChannel=!0)},z=function(){try{return"localStorage"in a&&null!==a.localStorage}catch(b){return!1}},A=function(a){var c,d=b.fns.getVal;return d?c=d(e(a)):b.hasLocalStorage&&(c=localStorage[e(a)]),c?JSON.parse(c):void 0},B=function(a,c){var d=b.fns.setVal;return d?d(e(a),c?JSON.stringify(c):null):void(b.hasLocalStorage&&(localStorage[e(a)]=c?JSON.stringify(c):null))},C=function(a){var c="cart";a?B(c,a):B(c,null),b.fns&&b.fns.onCartChange&&b.fns.onCartChange(a)},D=function(){var a=A("cart");if(a){var b=new Date,c=new Date(b-864e5);if(Date.parse(a.timeStamp)>c)return a}},E=function(){return A("images")},F=function(){b.lastOpts.usePushState&&history.pushState&&(history.pushState({to:"start"},null),b.hadHistWire||(a.addEventListener("popstate",function(a){var d=a.state;d&&d.n&&(b.justPopped=!0,k()("PIO: POP! "+d.n),c.msg("goto",d.n))}),b.hadHistWire=!0))},G=function(){var b=a.document;b.addEventListener("DOMContentLoaded",function(){var a,c="pio-js-country",d=b.getElementsByTagName("script")[0];b.getElementById(c)||(a=b.createElement("script"),a.id=c,a.async=!0,a.src="//printio-geo.appspot.com/ip/jsonp?callback=PIO._c",d?d.parentNode.insertBefore(a,d):b.head.appendChild(a))})},H=function(){var a=D();return a&&a.items?a.items:[]},I=function(){var a=b.opts.style,c=!1;b.opts=l(b.opts,{images:[],items:[],goTo:"",goToCustomize:!1,orderId:null}),a&&a.cssUrl&&0!==a.cssUrl.indexOf("http")&&0!==a.cssUrl.indexOf("//")&&(0!==a.cssUrl.indexOf("/")&&(c=!0),a.cssUrl=m(c)+a.cssUrl)},J=function(){b.opts.preLoad.on&&setTimeout(function(){b.lastOpts.url||c.open({fromPreLoad:!0})},1e3)};this.config=function(a,c){k()("config:",a),w();var d=l(f,a||{});b.opts=d,b.fns=d.fns,b.opts.fns&&delete b.opts.fns,c&&c(b),I(),b.hadConfig=!0,J()},this.open=function(a,d){k()("open:",a);var e=a;if(b.lastOpts.preLoad&&e.preLoad&&b.lastOpts.preLoad.hadPreLoad&&(e.preLoad.on=!1),e&&!e.fromPreLoad&&(e.preLoad&&e.preLoad.on||b.opts.preLoad&&b.opts.preLoad.on)&&(e.preLoad={on:!1},b.opts.preLoad.on=!1),b.lastOpts={},b.lastOpts=b.hadConfig?l(l(f,b.opts),{}):l(f,{}),e&&e.preserveCollection){var g=c.getImages();null!=g&&(g.push.apply(g,e.images?e.images:[]),e.images=g)}b.lastOpts=l(b.lastOpts,e||{}),e&&e.fns&&(b.fns=b.hadConfig?l(b.fns,e.fns):l(f.fns,e.fns),delete b.lastOpts.fns),w(),H().forEach(function(a){b.lastOpts.items.push(a)}),p(!0),y(),F(),s(),r(n()),b.lastOpts.fns&&delete b.lastOpts.fns,b.lastOpts.embedInElement&&(b.lastOpts.embedInElement=null),b.lastOpts.preLoad.on&&(b.lastOpts.preLoad.hadPreLoad=!0,b.lastOpts.preLoad.on=!1),b.opts.preLoad&&(b.opts.preLoad.on=!1),d&&d(b),b.fns.onOpen&&b.fns.onOpen()},this.getOptions=function(){return b.lastOpts},this.close=function(){t({cmd:"close",data:{}})},this.msg=function(a,b){b=b||1,x(a,b)},this.showCart=function(a){o()?x("goto","tpl-cart"):(a=a||{},a.goTo="tpl-cart",c.open(a))},this.clearCart=function(){C(null)},this.getCart=D,this.getNumItems=function(){w();var a=H();return a.length?a.reduce(function(a,b){return a+=b.quantity},0):0},this.getImages=E,this._c=this.setFallbackCountry=function(a){b.fallbackCountry=a,B("countryCode",a)},w()};a.PIO=new b,a.PIO.ctor=b}(window);